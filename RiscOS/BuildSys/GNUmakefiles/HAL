# Makefile for HALs

INCLUDED_HAL = YES

# This makefile provides the following phony targets:
#
#    resources  rom  install_rom  _debug
#
# It inherits most of its properties from the CModule makefile.

HDRS       =
CMHGFILE   =
CUSTOMRES  = custom
CUSTOMROM  = custom
ROM_TARGET = custom
LNK_TARGET = custom
AIFDBG     = _${TARGET}.aif
GPADBG     = GPA.gpa

include CModule

ifneq (objs,$(notdir ${CURDIR}))

# Makefile invoked from same directory
# All other phony targets already handled by CModule

install_rom _debug: links

else

# Makefile invoked from objs subdirectory

resources:
	@${ECHO} ${COMPONENT}: no resources

rom: ${TARGET}.aof
	@${ECHO} ${COMPONENT}: HAL built

_debug: ${GPADBG}
	@${ECHO} ${COMPONENT}: debug image built

install_rom: ${TARGET}.linked
	${CP} ${TARGET}.linked ${INSTDIR}/${TARGET}
	@${ECHO} ${COMPONENT}: HAL installed

${TARGET}.aof: ${ROM_OBJS_} ${ROM_LIBS} ${DIRS} ${ROM_DEPEND}
	${LD} -o $@ -aof ${ROM_OBJS_} ${ROM_LIBS}

${TARGET}.linked: ${TARGET}.aof
	${LD} ${LDFLAGS} ${LDLINKFLAGS} -o $@ -bin -base 0xFC000000 ${TARGET}.aof

${AIFDBG}: ${ROM_OBJS_} ${ROM_LIBS}
	${MKDIR} aif
	${LD} -aif -bin -d -o ${AIFDBG} ${ROM_OBJS_} ${ROM_LIBS}

${GPADBG}: ${AIFDBG}
	${TOGPA} -s ${AIFDBG} ${GPADBG}

endif

#EOF
