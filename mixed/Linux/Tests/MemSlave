LIBRARY "RAM:Lib"
PROCinit("Test Slave")

REPEAT
  SYS "Wimp_Poll",0,buffer% TO R%
  CASE R% OF
   WHEN 17,18
    CASE buffer%!16 OF
     WHEN 0
      QUIT
     WHEN test_message%
      R$ = STR$(EVAL($(buffer%+20)))
      buffer%!0=256
      buffer%!12=buffer%!8
      $(buffer%+20) = R$
      SYS "Wimp_SendMessage", 17, buffer%, buffer%!4
    ENDCASE
  ENDCASE
UNTIL FALSE
