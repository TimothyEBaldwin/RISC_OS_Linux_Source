REM ZeroPain Register Test
DIM C% 256
P% = C%
[OPT 2

        DCD     &FDFDFDFD
        DCD     &FDFDFDFD
        DCD     &FDFDFDFD
        DCD     &FDFDFDFD
        DCB     "!!!!NULL.POINTER.DEREFERENCE!!!!"
        DCB     0
        ALIGN

.start%
        PUSH    {lr}
        MOV     r1, #start% - C% - 4

.loop%
        LDR     r6, [r2, r1]
        SWI     "OS_EnterOS"
        MOV     r14, r1
        LDR     r4, [r1]
        TEQ     r14, r1
        BNE     P%
        SWI     "OS_LeaveOS"
        TEQ     r14, r1
        BEQ     P%
        MOV     r14, r1
        LDR     r5, [r1]
        TEQ     r14, r1
        TEQEQ   r4, r6
        TEQEQ   r5, r6
        BNE     P%
        SUBS    r1, r1, #4
        BPL     loop%
        POP     {pc}
]

CALL start%
PRINT "ZeroPain Tested"
