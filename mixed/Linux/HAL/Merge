code%=OPENUP("HAL_Linux")
data%=OPENIN("HAL_Linux/rw")

rw_size% = EXT#data%
DIM buffer% rw_size%

REM Read offset value from second ELF program header
rw_offset%=FNread(4, FNread(4, &1C) + FNread(2, &2A) + 4)

REM Copy data
SYS "OS_GBPB", 3, data%, buffer%, rw_size%, 0
SYS "OS_GBPB", 1, code%, buffer%, rw_size%, rw_offset%

CLOSE#code%
CLOSE#data%
END

DEF FNread(S%, I%)
!buffer%=0
SYS "OS_GBPB", 3, code%, buffer%, S%, I%
=!buffer%
